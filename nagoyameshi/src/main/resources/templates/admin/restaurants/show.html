<!DOCTYPE html>
<html xmlns:th=”https://www.thymeleaf.org” xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
	<head>
		<div th:replace="~{fragment :: meta}"></div>
		
		<div th:replace="~{fragment :: styles}"></div>
		
		<title>（管理者用）店舗詳細</title>
	</head>
	<body>
		<div class="nagoyameshi-wrapper">
			<div th:replace="~{fragment :: header}"></div>
			
			<main>
				<nav class="breadcrumb-box" style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">                        
                        <li class="breadcrumb-item"><a th:href="@{/admin/restaurants}">店舗一覧</a></li>
                        <li class="breadcrumb-item active" aria-current="page" th:text="${restaurant.getName()}"></li>
                    </ol>
                </nav> 
                            
                <h1 class="mb-4 text-center" th:text="${restaurant.getName()}"></h1>
                
				<div class="container">
                    <div class="row justify-content-center">
                        <div class="col-md-6 col-12">
							<h5 class="nagoyameshi-h5 mt-0 text-center">店舗情報</h5>
                            
                            <div class="d-flex justify-content-end align-items-end mb-3">                    
                                <div>
                                    <a th:href="@{/admin/restaurants/__${restaurant.getId()}__/edit}">編集</a>                                    
                                </div>
                            </div>                                                 
                            
                            <div class="mb-3">
                                <img th:if="${restaurant.getImageName()}" th:src="@{/storage/__${restaurant.getImageName()}__}" class="w-100" alt="店舗画像">
                                <img th:unless="${restaurant.getImageName()}" th:src="@{/images/noImage.png}" class="w-100" alt="NO IMAGE">
                            </div>   
                            
                            <div class="container mb-4">
								<!-- ID -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">ID</span>          
                                    </div>                                                  
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getId()}"></span>
                                    </div>
                                </div>
             					<!-- 店名 -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">店名</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getName()}"></span>
                                    </div>
                                </div>                    
             					<!-- 郵便番号 -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">郵便番号</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getPostalCode()}"></span>
                                    </div>
                                </div>   
                                <!-- 住所 -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">住所</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getAddress()}"></span>
                                    </div>
                                </div>   
                                <!-- 電話番号 -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">電話番号</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getPhoneNumber()}"></span>
                                    </div>
                                </div>
                                <!-- 営業時間 -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">営業時間</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getOpeningTime() + '~' + restaurant.getClosingTime()}"></span>
                                    </div>
                                </div>
                                <!-- 予算 -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">予算</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getMinBudget() + '~' + restaurant.getMaxBudget() + '円'}"></span>
                                    </div>
                                </div>
                                <!-- 説明 -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">説明</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getExplanation()}"></span>
                                    </div>
                                </div>
                                <!-- カテゴリ -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">カテゴリ</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.category.getName()}"></span>
                                    </div>
                                </div>
                                <!-- 席数 -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">席数</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getSeatingCapacity() + '席'}"></span>
                                    </div>
                                </div>
                                <!-- キーワード -->
                                <div class="row pb-2 mb-2 border-bottom">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">キーワード</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${restaurant.getKeyword()}"></span>
                                    </div>
                                </div>
                                <!-- お気に入り登録者数 -->
                                <div class="row pb-2 mb-2">
                                    <div class="col-5 text-center">
                                        <span class="fw-bold">お気に入り登録者数</span>
                                    </div>
             
                                    <div class="col text-center">
                                        <span th:text="${favoriteUsers + '人'}"></span>
                                    </div>
                                </div>
                            </div>                                                  
                        </div>
                        
                        <!-- レビュー（右側） -->
                        <div class="col-md-6 col-12">
							<h5 class="nagoyameshi-h5-right text-center">レビュー管理</h5>
							<div th:each="review : ${reviews}">
						        <div class="card nagoyameshi-review-card-column">
						            <div class="col-7 d-flex flex-column">
						                <div class="card-body flex-grow-1">
											<!-- タイトル -->
						                    <p class="card-title nagoyameshi-review-title" th:text="${review.getTitle()}"></p>
						                    <hr class="nagoyameshi-review-hr">
						                    <!-- コメント -->
						                    <p class="card-text nagoyameshi-review-text truncate-multiline">
						                        <span th:text="${review.getComment()}"></span>
						                    </p>
						                    <!-- 評価 -->
						                    <p class="card-text nagoyameshi-review-text">
						                        <span class="rate-wrap">
						                            <span class="rate-review" th:style="'--score: ' + ${review.getEvaluation()}"></span>
						                            <span class="review-score-num-sm" th:text="${review.getEvaluation()}"></span>
						                        </span>
						                    </p>
						                    <!-- 投稿日・非表示リンク -->
						                    <div class="nagoyameshi-review-bottom-box">
									            <p class="card-text nagoyameshi-review-text m-0">
									                <span th:text="${#dates.format(review.getCreatedAt(), 'yyyy/MM/dd')}"></span>
									            </p>
												<!-- 非表示リンク -->
												<a href="#" class="nagoyameshi-review-text nagoyameshi-link-danger" data-bs-toggle="modal" th:data-bs-target="${'#hiddenReviewModal' + review.getId()}">非表示</a>
											</div>
											<!-- 削除用モーダル -->
											<div class="modal fade" th:id="${'hiddenReviewModal' + review.getId()}" tabindex="-1" th:aria-labelledby="${'hiddenReviewModalLabel' + review.getId()}">
						                        <div class="modal-dialog">
						                            <div class="modal-content">
						                                <div class="modal-header bg-danger">
						                                    <h5 class="modal-title text-white" th:id="${'hiddenReviewModalLabel' + review.getId()}">非表示確認</h5>
						                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
						                                </div>
						                                <div class="modal-body">
															<p>レビューを非表示にしますか？</p>
														</div>
						                                <div class="modal-footer">
						                                    <form method="post"th:action="@{/admin/restaurants/__${restaurant.getId()}__/reviews/__${review.getId()}__/hidden}">
						                                        <button type="submit" class="btn nagoyameshi-btn-danger text-white shadow-sm">非表示</button>
						                                    </form>
						                                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">キャンセル</button>
						                                </div>
						                            </div>
						                        </div>
						                    </div>
						                </div>
						            </div>
						            <div class="col-5 d-flex align-items-center justify-content-center">
						                <img th:if="${review.getImageName()}" th:src="@{/storage/__${review.getImageName()}__}" class="nagoyameshi-review-card-right-img" alt="店舗画像">                                                     
						                <img th:unless="${review.getImageName()}" th:src="@{/images/noImage.png}" class="nagoyameshi-review-card-right-img" alt="NO IMAGE">
						            </div>
						        </div>
						    </div>
							<div class="nagoyameshi-flex-end">
								<a th:href="@{/admin/restaurants/__${restaurant.getId()}__/reviews}">すべてのレビューを管理する</a>
							</div>
						</div>
                    </div>
                </div>
			</main>
			<div th:replace="~{fragment :: footer}"></div>	
		</div>
		<div th:replace="~{fragment :: scripts}"></div>
	</body>
</html>